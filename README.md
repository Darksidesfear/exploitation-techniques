# Exploitation techniques
[![Hits](https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fgithub.com%2Fandrewbae%2Fexploitation-techniques&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=false)](https://hits.seeyoufarm.com)

## _rtld_global Overwrite

### Conditions

- The `&_rtld_global._dl_rtld_lock_recursive`  and `&_rtld_global._dl_load_lock` member must be overwritable.
- After overwriting them, the program must invoke the `_GI_exit` .

### Description

The `_GI_exit`  invoke a `_run_exit_handlers` then `_run_exit_handlers` invoke a `_dl_fini`.

`_dl_fini` function is located at `/glibc/elf/dl-fini.c(ld.so)`

```c
void
_dl_fini (void)
{
  for (Lmid_t ns = GL(dl_nns) - 1; ns >= 0; --ns)
    {
      /* Protect against concurrent loads and unloads.  */
      __rtld_lock_lock_recursive (GL(dl_load_lock));
```

The `__rtld_lock_lock_recursive` and `dl_load_lock` are member of `_rtld_global` struct. 

A Region of `_rtld_global` is having a write permission and both  members used for invoking a function at `_dl_fini` . The attacker can control Instruction Pointer with abusing this.

`&_rtld_global._dl_rtld_lock_recursive` is used for storing a function address who will be invoking.

`&_rtld_global._dl_load_lock` is used for storing an argument.

## _hook Overwrite

### Conditions

- `__func_hook` can be overwritable.
- `func`  to be invoke after overwrite.

### Description

The GNU C Library provide `__malloc_hook`, `__realloc_hook`, `__free_hook` variables for controlling the `malloc`, `realloc`, `free` function's flow.

These hooking variables are located at writable area, hacker can control the Instruction Pointer(IP) if these variables are overwritten.
